                                                                Doug Schuster
                                                                Gregg Walters
                                                                July 22, 2010

USING THE BUFR DECODING SOFTWARE

FOR SURFACE DATA IN THE NCAR RDA DATASET DS461.0
(NCEP ADP GLOBAL SURFACE OBSERVATIONS, DAILY OCT1999-CONTINUING)

Here is a list of the bufr_configdecode sub-directories and their descriptions.

    bufrobs     Use to hold BUFR data files for the dumpbufr.x decoder.
                  There is a README which describes how to handle some
                  machine dependencies.

    configs     Has a few sample configuration files, to be read by
                  the BUFR decoder, plus a descriptive template.

    doc         Contains a file showing some basic parameter mnemonics
                  and a link to recent NCEP BUFR tables.

    exe         Where the install places the decoder executables.

    grabbufr    Has a conversion to make BUFR files readable on
                  little_endian machines, such as linux machines.

    install     Has a shell script for compiling and installing BUFR
                  decoders.

    lib         NCEP BUFR decoder support library - mostly FORTRAN
                  source code, plus a few C source codes.

    src         Two FORTRAN BUFR decoder source code files.  A
                  flexible, user configurable program plus a simple
                  dumping program.

    textobs     Used to receive text files generated by the decoders.


All directories (except "textobs") contain their own README files.

** The following text lists the steps necessary to build the software and
   decode the BUFR data. Steps include preparing the decoder software, preparing
   the input files, preparing the configuration files, 
   and finally running the decoder software.  *****

1.  PREPARING THE DECODER SOFTWARE:

   -To compile the BUFR libraries and extraction code, go to the "install"
    directory and set the CPLAT variable in the install.sh script to reflect the
    correct platform.  Initially CPLAT=linux.  Execute the install.sh script
    to complete the compilations.  The executables will be placed in the
    "exe" directory.  You could copy them to an arbitrary directory,
    notably your bin, where they could be executed from anywhere.

    bufr_configdecode/exe/bufrsurface.x:  used to make a selective dump from either
                                       gdas.adpsfc.tHHz.YYYYMMDD.bufr files
                                       gdas.sfcshp.tHHz.YYYYMMDD.bufr files

    bufr_configdecode/exe/dumpbufr.x:     used to dump all contents of a BUFR file.

2.  PREPARING THE INPUT FILES:

    -Place your downloaded files, which have the naming structure "gdassfcobs.yyyymmdd.tar.gz",
     in the bufrobs directory.
    -Edit the "exe/preprocess.csh" script to reflect the proper directory path to the decoder software
     "set procdir=$home/bufr_configdecode", and the correct platform "set CPLAT=linux".
    -Execute the "exe/preprocess.csh" script.
    -All individual BUFR files are extracted and placed in the "BUFROBS" directory. 
    -File names must appear in the following format to proceed further:
          gdas.adpsfc.tHHz.YYYYMMDD.bufr          (land surface)
          gdas.sfcshp.tHHz.YYYYMMDD.bufr          (marine surface) 
        
3.  PREPARING THE CONFIGURATION FILE:
 
    -Go to the "configs" directory for default configuration examples, and instructions
     on how to build your configuration file.
    -Copy the completed configuration file into the "bufrobs" directory.  The name of the
     production configuration file needs to be "bufrsurface_config".
    -Ensure that the configuration file includes the names of all BUFR files that you would
     like to be operated on. 
    
4.  RUNNING THE DECODER SOFTWARE:

    -To decode the BUFR data according to the instructions in your configuration file,
     go into the "bufrobs" directory and execute "../exe/bufrsurface.x"
    -To generically dump output from an individual file, go into the "bufrobs" directory and execute
     "../exe/dumpbufr.x".  From here you will be prompted to enter the name of the file
     from which you would like all output to be dumped. 



*** Additional information ***

Downloading the RDADB ds461.0 BUFR data files is supported from the "Data Access"
tab near the top of the ds461.0 home page

    http://dss.ucar.edu/datasets/ds461.0/ 

RDA ds461.0 file names have the form: gdassfcobs.yyyymmdd.tar.gz. Individual
BUFR files must be extracted from the tar.gz files for use with the decoders. 
This can be done after files are copied to the "bufrobs" directory, by editing
and running the "exe/preprocess.csh" shell script.

Linux users must preprocess all BUFR files using the "preprocess.csh" script, or
the "grabbufr" tool on individual BUFR files.
